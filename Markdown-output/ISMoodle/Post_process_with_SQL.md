# Post process with SQL

### Not sure this is needed

<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="container" title="Hint: double-click to select code">
<div class="line number1 index0 alt2">
<code class="sql comments">-- Set email address to black hole for all but moodl/trail accounts.</code>
</div>
<div class="line number2 index1 alt1">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_user</code>
</div>
<div class="line number3 index2 alt2">
<code class="sql keyword">SET</code> <code class="sql plain">email =  </code><code class="sql string">'nobody@ucl.ac.uk'</code>
</div>
<div class="line number4 index3 alt1">
<code class="sql keyword">WHERE</code> <code class="sql plain">id  </code><code class="sql color1">NOT</code> <code class="sql color1">IN</code> <code class="sql plain">(</code>
</div>
<div class="line number5 index4 alt2">
<code class="sql spaces">     </code><code class="sql keyword">SELECT</code> <code class="sql plain">A.id </code><code class="sql keyword">FROM</code> <code class="sql plain">mdl_user A</code>
</div>
<div class="line number6 index5 alt1">
<code class="sql spaces">     </code><code class="sql keyword">WHERE</code> <code class="sql plain">A.username  </code><code class="sql color1">LIKE</code> <code class="sql string">'moodl%'</code> <code class="sql color1">OR</code> <code class="sql plain">A.username  </code><code class="sql color1">LIKE</code> <code class="sql string">'trail%'</code>
</div>
<div class="line number7 index6 alt2">
<code class="sql plain">);</code>
</div>
</div></td>
</tr>
</tbody>
</table>

 

### Update sits filter views

To update dependent views in the appropriate `moodle_sits_management_???2` database, execute the SQL which is generated by the following to recreate each of the views...

 

<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="container" title="Hint: double-click to select code">
<div class="line number1 index0 alt2">
<code class="sql keyword">SELECT</code>
</div>
<div class="line number2 index1 alt1">
<code class="sql spaces">     </code><code class="sql plain">TABLE_SCHEMA</code>
</div>
<div class="line number3 index2 alt2">
<code class="sql spaces">   </code><code class="sql plain">, TABLE_NAME</code>
</div>
<div class="line number4 index3 alt1">
<code class="sql spaces">   </code><code class="sql plain">, CONCAT( </code><code class="sql string">'CREATE OR REPLACE VIEW '</code> <code class="sql plain">, TABLE_SCHEMA,  </code><code class="sql string">'.'</code> <code class="sql plain">, TABLE_NAME,  </code><code class="sql string">' AS '</code> <code class="sql plain">,</code>
</div>
<div class="line number5 index4 alt2">
<code class="sql spaces">            </code><code class="sql color2">REPLACE</code> <code class="sql plain">(VIEW_DEFINITION,  </code><code class="sql string">'`moodle_live`.'</code> <code class="sql plain">,  </code><code class="sql string">'`moodle_devxxxx`.'</code> <code class="sql plain">),  </code><code class="sql string">';'</code> <code class="sql plain">)  </code><code class="sql keyword">AS</code> <code class="sql plain">sql_create</code>
</div>
<div class="line number6 index5 alt1">
<code class="sql keyword">FROM</code> <code class="sql plain">information_schema.VIEWS</code>
</div>
<div class="line number7 index6 alt2">
<code class="sql keyword">WHERE</code> <code class="sql plain">TABLE_SCHEMA =  </code><code class="sql string">'moodle_sits_management_dev2'</code>
</div>
<div class="line number8 index7 alt1">
<code class="sql color1">AND</code> <code class="sql plain">VIEW_DEFINITION  </code><code class="sql color1">LIKE</code> <code class="sql string">'%`moodle_live`.%'</code> <code class="sql plain">;</code>
</div>
</div></td>
</tr>
</tbody>
</table>

 

### Unlink google analytics

 

<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="container" title="Hint: double-click to select code">
<div class="line number1 index0 alt2">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` = 0  </code><code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'useanalytics'</code> <code class="sql plain">;</code>
</div>
<div class="line number2 index1 alt1">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` =  </code><code class="sql string">''</code> <code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'analyticsid'</code> <code class="sql plain">;</code>
</div>
<div>
<code class="sql plain"></code>
</div>
</div></td>
</tr>
</tbody>
</table>

 

### Set site name in Frontpage settings

Not with SQL, see other methods

 

### Set cookie prefix

Not with SQL, see other methods

 

### Set Blackboard collaborate to use test account

``` sql
-- Set Blackboard Collaborate to use test account (details in KeePass).
UPDATE mdl_config  SET `value` =  'https://eu1.bbcollab.com/site/external/adapter/default/v3'  WHERE ` name ` =  'elluminate_server' ;
UPDATE mdl_config  SET `value` =  'UCLEUMOODLETEST' WHERE ` name ` =  'elluminate_auth_username' ;

UPDATE mdl_config  SET `value` =  '<in KeePass>' WHERE ` name ` =  'elluminate_auth_password' ;
```

 

### Global string replace (host URL)

Not with SQL, see other methods 

### Changes to site settings

 

<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="container" title="Hint: double-click to select code">
<div class="line number1 index0 alt2">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` = </code><code class="sql string">''</code>  <code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'usepolicy'</code> <code class="sql plain">;</code>
</div>
<div class="line number2 index1 alt1">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` =  </code><code class="sql string">''</code> <code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'marketing1image'</code> <code class="sql plain">;</code>
</div>
<div class="line number3 index2 alt2">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` = </code><code class="sql string">''</code>  <code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'marketing2image'</code> <code class="sql plain">;</code>
</div>
<div class="line number4 index3 alt1">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` =  </code><code class="sql string">''</code> <code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'marketing3image'</code> <code class="sql plain">;</code>
</div>
<div class="line number5 index4 alt2">
<code class="sql keyword">UPDATE</code> <code class="sql plain">mdl_config_plugins  </code><code class="sql keyword">SET</code> <code class="sql plain">`value` =  </code><code class="sql string">''</code> <code class="sql keyword">WHERE</code> <code class="sql plain">`plugin` =  </code><code class="sql string">'theme_ucl'</code> <code class="sql color1">AND</code> <code class="sql plain">` </code><code class="sql keyword">name</code> <code class="sql plain">` =  </code><code class="sql string">'marketing4image'</code> <code class="sql plain">;</code>
</div>
</div></td>
</tr>
</tbody>
</table>

### 
Change other plugins settings as necessary

 
